{% extends "layout.html" %} {% block content %}
<main>
  <h1>Sessions</h1>
  <form action="/" method="post">
    <button type="submit" name="action" value="new">new</button>
  </form>
  {% for session in sessions_list %}
  <form action="/" method="post">
    {{ session }}
    <input type="hidden" name="session" value="{{session}}" />
    <button
      type="submit"
      name="action"
      value="toggle"
      id="state_{{session}}"
      onclick="toggle_session('{{ session }}')"
    >
      {% if session in running %} STOP {% else %} START {% endif %}
    </button>
    <button type="button" onclick="show_infos('{{ session }}')">INFOS</button>
    <button
      type="submit"
      name="action"
      value="delete"
      onclick="delete_session('{{ session }}')"
    >
      DELETE
    </button>
    <button
      type="submit"
      name="action"
      value="edit"
      onclick="edit_session('{{ session }}')"
    >
      EDIT
    </button>
    <br />
  </form>
  {% endfor %}

  <h1>Infos</h1>
  <pre id="infos"></pre>
</main>
<script>

  function delete_session(session) {

  }

  function edit_session(session) {

  }

  function toggle_session(session) {
      var button = document.getElementById("state_"+session);
      if (button.innerHTML.includes("START")) {
          button.innerHTML = "STOP";
      } else {
          button.innerHTML = "START";
      }
  }

  function show_infos(session) {
      var dict = {};
  {% for session in sessions_infos %}
      dict["{{session[0]}}"] = {{session[1]|tojson|safe}}
  {% endfor %}
      var infos = document.getElementById("infos");
      infos.innerHTML = JSON.stringify(JSON.parse(dict[session]), null, 2);
  }
</script>
{% endblock %}
